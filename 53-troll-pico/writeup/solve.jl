using TropicalNumbers

# Copy the functions
function TropicalAM(X, Y)
  return X + Y + X * Y
end 

function TropicalSDP(X1, Y1, X2, Y2)
  return TropicalAM(X1, Y2) + X2, TropicalAM(Y1, Y2) 
end  

function TropicalBinomial(X, Y, n)
  s = 0
  oX, oY = dX, dY = X, Y
  while n > 0
    if n % 2 == 1
      if s == 0
        oX, oY = dX, dY
        s = 1
      else
        oX, oY = TropicalSDP(oX, oY, dX, dY)
      end
    end
    dX, dY = TropicalSDP(dX, dY, dX, dY)
    n = n >> 1
  end
  return oX, oY
end

function Encrypt(T, K)
  K = map((x)->parse(Int32, chop(string(x))) % 256, K)
  T = map(xor, T, K)
  return T
end

# Copy from output and remove that funny character
M=TropicalMinPlusI32[35419 61065 47498 6085 44879 51096 21414 26165 51217 6508 16899 37934 41714 6063 17072 34820 51684 56555 16582 46957 15116 31377 60665 39618 6655 25811 40193 62201 675 14196 43188 60561; 36053 49974 22509 41211 2402 61204 35841 26573 13687 36616 38716 23959 30795 7557 64483 11423 4913 64415 904 45188 15514 40247 6417 45753 43590 7734 33736 19 5922 10266 21293 23973; 20221 41894 36773 3678 25841 59620 36881 47821 51143 34727 58545 30248 36606 65534 43370 18542 7546 36224 39895 7514 29252 45349 32869 8072 45604 14961 41924 27368 38875 11422 22990 47496; 38282 15111 14992 52570 37266 31899 59051 42391 46782 37331 53611 28051 3461 22320 21344 11853 3603 33328 13281 15587 34786 64576 64410 3586 26234 42019 21234 55223 34057 6443 47467 58888; 60312 55796 10031 40602 22287 9243 56834 31009 40255 43725 23893 42873 47510 58477 6344 38558 32636 16973 20323 51844 48081 3998 55818 13875 44587 4171 34157 45854 19318 15828 15831 64639; 58852 19275 28112 17727 30399 2309 49741 15758 61258 58345 17605 23201 46227 54178 20057 22763 3951 44231 42677 25384 7288 32271 55767 19093 60755 37207 56158 52349 33024 13017 27544 53047; 2032 48962 21498 60956 64285 84 55300 1296 28078 23684 34227 20283 10938 27968 25838 52232 40574 54071 15704 36186 23051 18366 22190 23665 44862 61141 59759 9487 58011 59425 42474 15418; 45272 47673 6434 64941 16426 57670 17707 60449 22256 13532 50283 11442 24383 58350 32783 48528 56383 46238 20286 31665 16338 48603 39862 16745 52497 4709 58119 31797 47160 61630 11008 45261; 19438 26414 56940 51673 45427 59997 28274 55422 2844 17892 57109 63713 60355 60485 48434 61872 20096 37171 54615 41182 33888 7936 4623 39942 3523 11137 55986 37897 26923 7996 63741 31595; 4565 39901 10405 17256 34099 15248 62903 36555 18136 10227 44992 61863 10089 17609 59113 62770 62659 39938 23773 24724 4562 61466 63430 25477 6061 59882 11210 50742 11586 49277 45808 42552; 18085 7542 37089 39359 38790 6632 37786 38323 7298 2194 40229 54500 11469 14847 34765 13763 13336 24927 38390 25151 35664 53137 30272 28981 64554 18541 59305 11835 3633 45635 48396 30351; 60641 28003 63618 3847 36572 13769 26833 11205 35170 63773 34310 65463 3448 344 17182 1677 19000 52630 27975 40111 18721 12743 35564 15438 14843 16993 38767 58116 8265 59769 19132 64228; 32257 40980 33402 8260 23378 60970 609 26145 31203 18875 53382 21950 34857 29083 38707 26512 8447 25248 12344 61817 49129 6765 38374 10802 8869 50028 40195 23504 22344 53344 15005 2223; 63288 34713 51028 21647 36414 43617 10217 52179 39935 34700 45548 11896 29589 63078 64314 35357 52055 9706 25304 26022 10851 37379 51020 30369 57119 42382 59449 40213 10089 42561 10492 29870; 55379 21039 2693 44783 43650 32266 52798 53267 18276 35771 57644 37171 59076 38450 9107 5395 62008 33183 13164 28521 61398 25919 25073 24848 2802 51411 14033 39559 54471 11427 32011 45643; 38211 32299 60184 35460 5396 37506 33398 31111 27935 15101 59428 63831 60413 50238 25635 30743 26758 13446 5258 56494 58648 3511 38851 59120 45402 35410 55163 64760 59997 21308 47534 21784; 12429 61194 11167 23281 5282 58798 20597 63689 53930 17822 33789 22164 37180 42824 55196 5722 5502 36680 31608 14177 4345 24212 57341 5892 63886 8259 2487 60853 44618 50017 52988 19175; 5679 15604 20701 2381 21761 50949 28668 43170 14524 11900 36730 827 49525 19900 65389 36649 58898 33379 9912 52226 64461 18725 1497 62172 24040 4783 50227 49792 64142 23122 43222 27373; 12191 17227 9427 36170 17152 52592 19775 43055 56185 43735 1151 61033 21983 54377 60009 18088 50402 10999 48035 14917 39004 8269 37266 50399 64496 16075 20671 64705 6794 19287 8221 4905; 48779 32344 6025 15442 11340 36653 64117 42112 61298 20382 58993 10648 51673 4475 23548 34940 58624 63727 27061 29573 14114 3611 28456 4708 63306 39113 1217 43794 31226 5024 4491 19814; 26998 52815 18955 45988 61055 11157 9383 31955 8142 33719 47767 48466 3470 3381 37713 18095 62251 29128 45416 53256 34831 49061 8749 17586 16880 38383 1660 18731 47141 30063 54048 18868; 32571 60267 56327 33780 18488 56627 63379 27623 23139 65143 43216 9839 4527 22015 21570 39670 48498 60053 11723 26359 34286 3598 40165 1608 8715 7795 43232 42436 21580 52666 15212 25312; 58705 20850 20337 58180 1703 32360 24059 42376 28492 39161 30054 62383 22117 64122 45939 56515 10542 27306 48169 22682 5182 9111 14197 52958 25944 49211 53303 60716 56102 3974 64612 38092; 28310 7624 5300 64678 20300 64385 40314 5113 50481 16015 14931 8694 17778 17435 52645 24598 35807 5119 56805 21436 63418 39176 7681 59079 36174 9510 61045 42649 11650 47941 36497 21081; 61258 17470 24645 15088 14823 25245 392 54392 61447 58933 26648 18949 44610 21564 61560 7083 4746 11328 27195 46027 57614 45850 11236 42202 29121 53737 59956 27136 20256 60514 4086 18569; 45051 6744 12086 16363 29775 572 32898 33132 53250 15544 45427 36800 15992 33521 11824 65098 11817 19056 14602 23155 285 10259 20808 34803 53092 35978 38909 47340 54357 10183 50427 33614; 5458 18158 30119 11848 62857 39076 61420 22015 54322 18506 985 32866 58936 37518 8886 28094 33919 64702 50236 13014 13318 52508 32995 37538 49943 37542 147 52449 8898 546 37474 23373; 31378 45520 15159 42941 53770 45290 64636 3762 22262 23837 12549 60924 31952 16236 47714 53430 41574 35979 16948 9103 5410 61317 7973 62192 42360 49364 53318 8050 6182 3472 18370 57988; 5721 1510 38939 58961 12396 40364 51684 7691 60081 16670 8642 63337 31689 16691 31074 35378 4475 51636 16307 43300 1270 36205 46694 60134 20268 41144 52495 43315 9786 57778 62944 59931; 29809 20253 25335 52500 5 41883 45501 11984 26712 29435 13631 42182 3554 36662 22643 44052 33776 49748 16384 47749 7980 53115 42148 60025 50917 54692 60843 56279 15083 16419 11198 43231; 3663 11038 30510 59405 61233 11249 57470 4672 40308 28784 25453 915 13646 10575 13663 22367 20023 55750 61226 38870 351 1505 47260 17694 34034 6073 43339 37846 25484 44476 27596 5411; 46571 64985 39179 49183 2209 62100 64599 13748 36576 65151 19146 45019 48734 29678 60919 58693 14923 13372 4735 35031 33194 51852 50350 62073 43321 47926 25500 8853 43568 28121 12417 63787]
H=TropicalMinPlusI32[9153 38626 24316 474 13699 41322 45932 13596 25242 20383 38648 29460 40327 17272 51225 7445 34366 58057 40886 36414 6946 32411 36833 64920 44725 38242 6805 31983 30747 37599 29781 4500; 46676 41326 16388 5088 10204 23808 14329 52169 62910 5899 46444 39797 7688 15499 3772 36321 10275 3319 1053 54800 45559 17083 52555 16728 38192 33531 1265 51347 59829 58515 45508 30351; 39389 64262 47347 11150 12571 50833 12689 20613 59627 22645 51330 18927 49247 62823 42757 61071 58379 35694 54171 38542 13465 11492 14998 25220 10114 18772 54658 4583 26767 40290 55421 48893; 43778 23827 3488 37613 37004 3031 48146 27237 797 34507 58965 21744 7562 43846 37125 46260 18938 13041 50839 9676 9448 58072 39353 48526 29048 3018 51017 16404 60410 55777 24585 11985; 42719 43207 33281 32584 25762 269 47505 33040 59152 21919 2883 28332 17016 13392 34707 11787 21254 53125 1298 4194 54681 28933 53780 14815 16160 9996 62091 46068 33880 1788 50207 56805; 56523 5334 26764 61029 8941 33870 9562 52304 26194 48844 3603 15686 11976 11303 25844 21486 50237 30897 31850 13252 29447 51089 14943 16639 743 41447 38101 469 27771 55453 28102 28419; 948 7849 39205 64951 52382 13999 52185 16879 59912 24530 13937 2910 43437 20449 22223 59139 18596 9943 3703 19514 36642 55776 57903 64009 35442 65359 25663 13080 32991 55825 18769 9069; 51222 3227 27164 28926 36931 36943 20664 44901 32020 38557 32688 20403 9241 15651 46984 47959 25639 45752 60905 32826 11668 47684 37777 38486 38242 46299 6890 682 42499 38594 41452 22184; 51522 48949 28117 49459 37442 45651 11206 60521 1907 49884 15674 45705 8671 2914 37354 28437 23807 49296 44389 41140 840 54939 7864 1350 61424 27614 44676 52114 27090 2787 39212 23633; 6510 32768 43559 64946 30776 5074 58271 19017 61592 28692 26844 12475 44954 21661 14625 49863 10307 27814 39868 7750 59359 54004 50488 42060 52213 24614 51823 30757 59389 16671 55422 3233; 49454 11774 37294 20953 8060 20446 44499 27518 56030 19111 5620 48658 39578 33900 37863 11121 3656 46985 25344 15708 28242 55849 24153 58406 12366 36650 40464 6910 27317 62437 19924 26380; 3178 14451 1553 44408 53856 47800 60767 21255 32257 3466 30214 16003 39792 36751 20181 1293 63609 29139 36514 41632 63132 13602 61722 59233 15081 41294 35616 9270 13724 17857 39823 60022; 23148 6820 41605 19188 14332 7751 40015 5362 22690 8949 6296 53736 28677 39321 59321 2061 4870 14450 62055 52583 48764 4607 51898 25406 47789 11007 7391 5759 53921 2714 56427 10236; 31341 57132 39108 25800 36380 38675 18342 10144 59377 49049 11140 4799 3628 37047 37366 38393 21592 9181 35781 26145 36195 44961 47084 56236 18652 6671 32736 50735 9853 12381 36273 59802; 5273 15238 323 28294 40341 30577 33748 61509 35208 4126 46255 43495 10218 11724 21940 246 49369 53425 13849 9010 58968 64840 41733 3067 21648 54997 3740 53106 55075 34059 16715 24335; 60261 27577 12180 49778 51015 5583 41072 55287 33131 2082 26444 22344 41886 59221 8724 36225 14820 26891 42518 12715 55323 34413 44116 43205 30078 10696 63005 15239 26442 2053 30254 52173; 18316 47167 31582 63844 62206 38811 48166 16322 27611 64678 36594 50019 25908 43089 52216 39838 2393 33935 59420 55337 7189 1403 51245 9193 63957 24306 16746 55148 35311 20873 31780 172; 14579 38005 19935 1650 41195 22511 16566 33967 2737 38940 15516 58958 54611 21225 30692 19291 16547 51622 30458 56093 3389 8922 23941 8136 23547 60818 36700 50867 27115 48853 16201 52146; 20928 24909 33334 6133 24543 59186 31585 56785 3529 4907 33741 17425 59502 65143 41586 1273 35693 5444 5218 53445 15032 27752 18414 59294 10910 22286 34478 29380 36662 31158 53238 19297; 23818 26731 23084 27201 58943 55707 48511 59285 32908 39892 27033 792 21284 42410 65302 19723 49060 416 16169 64897 29799 39965 2994 17051 12173 58355 19122 5766 61315 56612 15851 33974; 11346 64814 58265 36943 24433 3557 48063 45314 37307 10001 6492 13108 23769 61252 18103 45994 18375 14864 51885 7092 15676 46262 41947 6316 50244 23523 28208 53056 42518 2575 8629 11520; 13715 34060 12669 17898 28110 6368 33826 43577 695 45138 61848 32069 20600 28844 25127 34289 29305 7497 56345 7800 46778 23510 48564 28151 8907 32122 48749 20653 19450 29152 28201 2699; 933 34211 8075 36844 53683 62870 38148 31235 4692 29575 27413 45828 2120 48222 9328 3224 56819 6385 44537 41588 29914 42177 20970 2264 23069 31944 12507 13947 23116 31155 54914 15710; 51336 30858 38412 21240 23985 45558 2217 19882 59349 20408 41952 48722 892 8299 36976 11380 40255 55958 26772 51041 5856 736 64513 2598 55687 41644 28434 10140 10957 30828 14337 21482; 21324 27311 50093 39930 41011 9189 37131 32544 6093 18942 17160 3494 22915 50691 37633 16048 12171 29456 49152 20233 26737 43342 25878 21588 4920 20576 2929 19078 15820 5090 2382 45457; 42297 5702 17782 41686 58248 44031 16395 43757 2694 16774 34632 22867 16075 9896 37290 736 48953 17981 54770 20579 19313 57195 57614 3264 63477 25546 14109 15249 39426 4382 41534 47110; 16569 20374 10831 59743 36744 52987 6583 41576 42391 46177 4837 38885 29045 40488 554 32220 17361 2732 53618 4965 57341 33805 2483 35610 16135 55549 29739 14551 39288 34515 58693 405; 55248 43810 58704 9590 31252 42872 43354 41671 34111 55127 58912 22808 29152 27652 65498 39435 12037 49653 39374 40190 16115 58366 50564 51101 50411 7561 58809 39240 35632 53551 53109 44666; 55574 19915 28697 11234 47511 7868 61475 8278 50940 30226 51634 8206 19401 52440 27093 39402 54461 41481 46094 37484 24890 60641 3392 35395 9175 17971 51929 63406 26299 51711 21655 58950; 23090 7779 1362 47040 56967 2396 15302 5334 3397 30335 17077 3229 22329 1552 40281 23743 37835 19144 14227 23978 60539 45055 8390 30207 29077 45370 60610 35513 29825 25486 10602 28488; 63716 24913 279 35509 53038 52104 61204 52275 52324 47953 12869 44470 41053 43734 24584 2097 40117 18905 60828 51515 6285 40967 4218 16237 59653 27566 15932 7315 36299 20583 52552 64588; 42849 59271 46335 34467 22913 19768 31734 13267 9049 13173 60239 63615 41781 13790 58211 26518 38247 8600 57184 28196 23440 48038 36426 61483 17516 47737 31158 13610 45947 47685 17150 50572]

# Bug: Ma==Mb when n is large
Ma=Mb=TropicalMinPlusI32[5000 8839 3962 474 12446 3505 4838 8875 1271 6310 7108 7287 3513 4185 7359 4228 8383 9537 8541 9203 2111 3357 4067 2621 4248 3492 6805 3974 675 4058 6630 4500; 4681 8005 2142 4969 2402 2671 7103 9452 4433 4147 5285 6908 5778 5670 1819 2065 4913 3319 904 6230 5273 5622 3748 4886 3414 7580 1265 19 5922 4118 5796 1670; 8990 12043 7166 3678 12571 6709 8042 12079 4475 9514 10312 8306 6717 7389 10935 7432 7546 7930 11745 7514 5315 6561 10508 5825 7452 6696 10381 4583 16782 7262 9834 7718; 5312 8365 3488 5786 11972 3031 4364 8401 797 5836 6634 6813 3039 3711 7257 3754 3603 9145 8067 8729 1637 2883 8661 2147 3774 3018 6703 3500 13104 3584 6156 3775; 7357 5603 3150 6260 9210 269 8260 7122 4693 4653 2883 4506 6935 3340 4495 2571 6539 4610 1298 4194 5533 3998 6424 6043 1012 4171 3941 738 13193 1788 3394 4346; 7088 5334 3404 7562 8941 2309 9510 11167 6049 6554 3603 4237 8185 7385 4226 4472 3951 6404 6387 8637 6889 5354 6155 7293 743 8030 3672 469 16563 5833 3125 4077; 948 4523 3488 1422 9025 84 5786 1296 2219 6285 3687 2910 4461 5133 4310 4203 7343 6488 3703 8721 3059 4305 6239 3569 827 4440 3756 553 14526 5006 3209 4161; 7908 3227 5369 8196 13431 9741 10190 12679 7403 7374 9329 10249 8865 8897 5046 5292 12719 6546 4280 9457 8243 8709 6975 7973 10484 4709 4492 682 18750 7345 11008 4897; 4515 9062 4149 4989 13338 4397 3567 7604 1907 6385 7332 6016 2242 2914 7006 4303 7112 8348 7270 7932 840 2086 4623 1350 3523 8007 6452 4866 12307 2787 5905 4785; 4565 10408 8478 5039 14015 5074 9403 12471 5836 10227 8677 8542 8078 8689 9300 8793 10307 8166 11461 7750 4562 7922 10744 7186 5817 8057 8746 5543 11586 7137 8199 3233; 7958 7542 9684 8432 8060 6632 9321 11911 5754 2194 5620 10736 7996 8668 9361 9607 3656 10360 8595 9944 6594 5059 7025 7104 7375 11450 8807 6910 3633 8541 9757 3828; 3178 10268 1553 3652 14124 5742 8016 8680 4449 3375 9345 5143 3448 344 9968 1293 8318 9525 11321 11125 5289 6535 11657 5799 6485 6670 9414 6136 8265 3346 8867 6608; 1557 6820 4076 2031 14003 5062 609 5362 2828 4143 6296 3519 5070 4266 7945 2061 4870 9756 4312 10760 3668 4607 9874 4178 5805 5049 7391 5531 14119 2714 8187 2223; 7977 10448 6352 8451 17679 8738 10217 8990 8930 7771 9924 4799 3628 7894 11573 5689 8498 9181 11501 15521 9770 8235 13245 9935 9481 6671 11019 9207 9853 6342 10492 8670; 5273 10029 323 5747 12894 4695 5284 7633 4498 2328 8298 5528 3959 3851 4294 246 8829 6472 8987 8705 5338 3803 6223 3067 2802 8765 3740 4906 13704 2299 5184 4145; 8460 9783 3415 8934 5396 4449 7773 7387 4206 2082 8052 5282 6448 3605 8675 6531 11318 10006 5258 9590 5046 3511 10443 5556 5192 10276 8121 4918 13458 2053 7574 5315; 5903 10885 3364 6377 5282 5551 5665 9702 2098 5369 7324 8114 4340 5012 3041 3287 2393 5219 6580 7452 2938 1403 4970 3448 6294 8259 2487 6020 14405 4885 8676 172; 2430 10015 2380 1650 13622 4681 5978 8979 2447 4202 8284 827 3617 5361 8907 2120 8487 7882 9681 10379 3287 4497 1497 3761 5424 4668 8353 5150 14551 4173 7806 6930; 8044 11056 4688 6133 9211 5722 7096 8660 3529 3355 1151 6555 5771 4878 9948 1273 4807 5444 5218 11105 4369 5615 10186 4879 6465 9151 9394 6191 6794 3326 8221 4905; 3927 10431 2094 2066 11340 5097 6430 9404 2863 4099 6054 792 5105 4475 1771 2017 9710 416 10133 6182 3703 3611 2994 4213 5840 5084 1217 5566 14328 4070 4491 1622; 5076 8891 2537 5550 12498 3557 7498 7909 5972 4542 6492 5804 3470 3381 2214 2460 8340 4392 9944 6625 6812 6017 4143 5281 4300 8568 1660 4026 13234 2575 6682 2065; 4773 9320 4844 5247 14033 5092 3825 7862 695 6643 8027 6711 2500 3609 9318 4561 7370 7497 7528 7800 1535 2344 8559 1608 5835 7795 8764 5561 12565 3482 8217 2699; 933 7306 4853 1407 1703 1972 4481 7482 2204 5306 4586 6209 2120 5043 6198 3224 6990 6313 3001 5897 3044 3000 8127 2264 2715 4425 5644 2441 13221 3491 5097 5433; 3165 7624 4968 3639 14769 5828 2217 5113 1431 5035 7188 5127 892 4345 8837 2953 5762 5119 5920 8536 2271 736 7681 2598 6571 6657 8283 5795 10957 3606 8953 3435; 1340 8241 2661 1814 13786 4845 392 10215 2611 5811 7766 3302 4853 5525 3483 3729 4746 5661 4095 7894 3451 4697 5412 3961 4920 4832 2929 5314 14918 5090 2382 3334; 6429 5702 3976 6903 9513 572 5481 8123 2694 2818 4175 4809 4156 4341 4798 736 7831 6976 6755 7377 285 4000 6727 3264 1315 8602 4244 1041 14194 2789 3697 4649; 3416 8276 877 3890 9045 2942 5838 5880 3943 2882 985 3775 4513 2098 554 800 4641 2732 9329 4965 4783 4357 2483 3621 3685 6908 147 3411 8898 546 6067 405; 8906 6989 4834 9380 14809 5868 10436 3762 6869 10076 9471 6701 8652 5024 8808 7994 12037 9519 8042 9103 5410 8955 7973 8219 6611 7561 8254 4444 6182 3472 8993 8659; 4325 1510 3652 4799 11714 4827 7873 7691 5596 5657 7612 7074 5512 5397 3329 3575 4475 4829 2563 7740 1270 5878 3392 5656 5570 7817 2775 5296 9786 3845 7952 3180; 6407 5608 1362 6265 5 274 6964 5334 3397 4658 2888 3229 3554 1552 4500 2576 6544 4615 1303 4199 4237 5483 6429 4747 1017 8223 3946 743 11405 1793 3399 4351; 3663 7899 279 4137 12849 3908 5767 4672 2200 4179 6843 915 4442 4478 8134 2097 9312 7859 8952 7443 351 1505 4218 3550 4651 6073 7580 4377 14331 2926 7033 4204; 9566 7812 5359 8469 2209 2478 10603 9331 7036 6862 5092 6715 9177 5549 6704 4780 8748 6819 3507 6403 7876 9122 8633 8386 3221 10508 6150 2947 15402 3997 5603 6555]

Cipher=[224, 34, 125, 165, 207, 196, 134, 215, 216, 152, 119, 6, 116, 74, 250, 109, 80, 23, 31, 8, 156, 149, 241, 2, 93, 110, 7, 130, 214, 54, 126, 1, 216, 8, 106, 193, 130, 166, 196, 239, 57, 193, 5, 67, 236, 224, 121, 104, 228, 108, 111, 247, 136, 89, 187, 151, 110, 25, 25, 44, 138, 137, 191, 229, 10, 42, 159, 212, 39, 35, 206, 132]

Mc, Hc = TropicalBinomial(M, H, 1<<23) # just set a or b as an arbitrary large number (but not too large...)
Kc = TropicalAM(Mc, Hc) + Mc

Plain = Encrypt(Cipher, Kc)
print(String(convert(Vector{UInt8}, Plain)))